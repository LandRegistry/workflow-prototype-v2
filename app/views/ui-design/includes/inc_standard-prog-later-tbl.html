<table id="progress_later_table" class="govuk-table hmlr-table-dynamic">
  
    <caption class="govuk-table__caption govuk-table__caption--m">Work items in progress later</caption>

    <thead class="govuk-table__head">
        <tr class="govuk-table__row">
          <th class="govuk-table__header" id="progress_later_priority_dates" scope="col">Priority date</th>
          <th class="govuk-table__header" id="progress_later_title_numbers" scope="col">Title number</th>
          <th class="govuk-table__header" id="progress_later_abrs" scope="col"><abbr title="A B R">ABR</abbr></th>
          <th class="govuk-table__header" id="progress_later_categories" scope="col">Category</th>
          <th class="govuk-table__header" id="progress_later_dates_obtained" scope="col">Date obtained</th>
          <th class="govuk-table__header" id="progress_later_next_actions" scope="col">Next action</th>
        </tr>
    </thead>


    {% if (showFlagging == 'true') %}
    <tbody data-case-ref="V667KXL" class="case">
      <tr id="row_6042" class="govuk-table__row case__data_row " >
        <td class="case__date" id="V667KXL_priority_date" headers="progress_later_priority_dates" data-table-dynamic="Priority date">
              
              20 August 2024
            
        </td>
        <td class="case__title-number" id="V667KXL_title_number" headers="progress_later_title_numbers" data-table-dynamic="Title number">
            <span class="case__inc"></span>
            DT334422

            <strong class="govuk-tag-expedite govuk-tag">
              Expedite
            </strong>
            
        </td>
        <td id="V667KXL_abr" class="case__abr" headers="progress_later_abrs" data-table-dynamic="ABR">
            V667KXL
            <div></div>
        </td>
        <td id="V667KXL_cat" class="case__category" headers="progress_later_categories" data-table-dynamic="Category">
          Application Processing: Executive Register Update Standard
        </td>
        <td class="case__date" id="V667KXL_dobtained" headers="progress_later_dates_obtained" data-table-dynamic="Date obtained">
            
            10 May 2024
            
        </td>
        <td id="V667KXL_next_action" class="case__next-action" headers="progress_later_next_actions" data-table-dynamic="Next action">
            
                New - Start to process
            
        </td>
      </tr>
      <tr id="row_6042_actions" class="govuk-table__row case__actions">
          <td colspan="6" data-table-dynamic="Options">
            <div class="case__actions-wrapper">
              <div class="case__left-hand-actions actions-spacing">
                <a class="govuk-link govuk-link--no-visited-state actions-spacing case__anchor govuk-!-font-size-16 govuk-!-display-inline-block"
                  href="#">Return to <abbr title="e-serve">ESRV</abbr>
                  <span class="govuk-visually-hidden">: case <abbr>V667KXL</abbr> to <abbr>DB2</abbr></span>
                </a>
              </div>
              <div class="case__right-hand-actions actions-spacing">

                  <form class="case__form" action="#" method="post" novalidate>
                    

                    <span class="govuk-visually-hidden">|</span>
                      
                    <a class="govuk-link govuk-link--no-visited-state case__refer-link case__anchor govuk-!-font-size-16 govuk-!-display-inline-block"
                    href="#">Refer<span class="govuk-visually-hidden"> case <abbr>V667KXL</abbr></span>
                    </a>

                    <span class="govuk-visually-hidden">|</span>
                      
                    <input id="btn_progress_now_6042" title="Move case V667KXL into your worklist" type="submit"
                        name="Work_on_this" class="govuk-!-display-inline-block govuk-link case__hyperlink case__progress-later-btn govuk-!-font-size-16" value="Work on this">

                    <span class="govuk-visually-hidden">|</span>
                      
                    <input id="btn_progress_later_6042" title="Progress case V667KXL later" type="hidden"
                        name="Progress_later" class="govuk-link govuk-link--no-visited-state case__hyperlink case__progress-later-btn govuk-!-display-inline-block govuk-!-text-align-centre govuk-!-padding-bottom-1 hmlr-link--min-width-48 govuk-!-font-size-16" value="Progress later">

                    <span class="govuk-visually-hidden">|</span>
                      
                    <a class="govuk-link govuk-link--no-visited-state case__defer-link case__anchor govuk-!-font-size-16 govuk-!-display-inline-block"
                    href="#">Defer<span class="govuk-visually-hidden"> case <abbr>V667KXL</abbr></span>
                    </a>

                    <span class="govuk-visually-hidden">|</span>
                  

                  
                      
                    <a class="govuk-link govuk-link--no-visited-state case__activity-history-link case__anchor govuk-!-font-size-16 ga_track_event govuk-!-display-inline-block hmlr-link--min-width-48"
                    href="#"
                    id="link_activity_history_V667KXL"
                    data-ga-category="Activity_History_Link_From_Worklist"
                    data-ga-action="Activity History link clicked from worklist page"
                    data-ga-label="Worklist_Activity_History_Link"
                    >View activity history
                    <span class="govuk-visually-hidden"> for <abbr>V667KXL</abbr></span>
                    </a>

                    <span class="govuk-visually-hidden">|</span>
                      
                    <a class="govuk-!-display-inline-block govuk-link govuk-link--no-visited-state case__more-info-link case__anchor govuk-!-font-size-16"
                      href="#">
                      More info
                    <span class="govuk-visually-hidden">: open daylist for case <abbr>V667KXL</abbr>. Opens in new window.</span></a>

                      <span class="govuk-visually-hidden">|</span>

                      <input type="submit" name="flagging-btn" id="add_flag_V667KXL" class="govuk-link govuk-link--no-visited-state govuk-!-display-inline-block govuk-!-text-align-centre govuk-!-padding-bottom-0 hmlr-link--min-width-48 govuk-!-font-size-16 hmlr-flag-icon-btn  case__hyperlink ga_track_event" value="Add flag">     
                      
                      <svg xmlns="http://www.w3.org/2000/svg" 
                      aria-hidden="true" 
                      height="24" width="21" 
                      viewBox="0 0 448 512" 
                      role="img" 
                      aria-labelledby="add_flag_V667KXL" 
                      class="hmlr-flag-icon">
                        <title id="title_V667KXL">Not flagged</title>
                        <!--desc id="desc">This acts as a reminder.</desc--><path fill="#0b0c0c" d="M64 32C64 14.3 49.7 0 32 0S0 14.3 0 32L0 64 0 368 0 480c0 17.7 14.3 32 32 32s32-14.3 32-32l0-128 64.3-16.1c41.1-10.3 84.6-5.5 122.5 13.4c44.2 22.1 95.5 24.8 141.7 7.4l34.7-13c12.5-4.7 20.8-16.6 20.8-30l0-247.7c0-23-24.2-38-44.8-27.7l-9.6 4.8c-46.3 23.2-100.8 23.2-147.1 0c-35.1-17.6-75.4-22-113.5-12.5L64 48l0-16z"/>
                      </svg>
                  
                  </form>
              </div>
            </div>
          </td>
      </tr>
    </tbody>

    <tbody data-case-ref="V273EZZ" class="case">
      <tr id="row_6042" class="govuk-table__row case__data_row " >
        <td class="case__date" id="V273EZZ_priority_date" headers="progress_later_priority_dates" data-table-dynamic="Priority date">
              
              11 June 2023
            
        </td>
        <td class="case__title-number" id="V273EZZ_title_number" headers="progress_later_title_numbers" data-table-dynamic="Title number">
            <span class="case__inc"></span>
            DT101462

            <strong class="govuk-tag-expedite govuk-tag">
              Expedite
            </strong>
            
        </td>
        <td id="V273EZZ_abr" class="case__abr" headers="progress_later_abrs" data-table-dynamic="ABR">
            V273EZZ
            <div></div>
        </td>
        <td id="V273EZZ_cat" class="case__category" headers="progress_later_categories" data-table-dynamic="Category">
          Application Processing: Executive Register Update Standard
        </td>
        <td class="case__date" id="V273EZZ_dobtained" headers="progress_later_dates_obtained" data-table-dynamic="Date obtained">
            
            19 February 2024
            
        </td>
        <td id="V273EZZ_next_action" class="case__next-action" headers="progress_later_next_actions" data-table-dynamic="Next action">
            
                New - Start to process
            
        </td>
      </tr>
      <tr id="row_6042_actions" class="govuk-table__row case__actions">
          <td colspan="6" data-table-dynamic="Options">
            <div class="case__actions-wrapper">
              <div class="case__left-hand-actions actions-spacing">
                <a class="govuk-link govuk-link--no-visited-state actions-spacing case__anchor govuk-!-font-size-16 govuk-!-display-inline-block"
                  href="#">Return to <abbr title="e-serve">ESRV</abbr>
                  <span class="govuk-visually-hidden">: case <abbr>V273EZZ</abbr> to <abbr>DB2</abbr></span>
                </a>
              </div>
              <div class="case__right-hand-actions actions-spacing">

                  <form class="case__form" novalidate
                      id="change_state_6042"
                      action="#"
                      method="post"
                      onsubmit="btn_await_lawyer_6042.disabled = true;
                                btn_progress_now_6042.disabled = true;
                                btn_progress_later_6042.disabled = true;">
                    
                    <input id="btn_await_lawyer_3011" title="Refer case V273EZZ to a lawyer" type="submit" name="Waiting_for_lawyer" class="govuk-link govuk-link--no-visited-state case__hyperlink case__await_lawyer_btn govuk-!-display-inline-block govuk-!-text-align-centre govuk-!-padding-bottom-1 hmlr-link--min-width-48 govuk-!-font-size-16" value="Waiting for lawyer" formaction="await_lawyer/3011?lr_ref_number=DU164181&amp;lr_work_ref=D348RWW">

                    <span class="govuk-visually-hidden">|</span>
                      
    <a class="govuk-link govuk-link--no-visited-state case__refer-link case__anchor govuk-!-font-size-16 govuk-!-display-inline-block"
    href="#">Refer<span class="govuk-visually-hidden"> case <abbr>V273EZZ</abbr></span>
    </a>

                      <span class="govuk-visually-hidden">|</span>
                      
      <input id="btn_progress_now_6042" title="Move case V273EZZ into your worklist" type="submit"
          name="Work_on_this" class="govuk-!-display-inline-block govuk-link case__hyperlink case__progress-later-btn govuk-!-font-size-16" value="Work on this">

                      <span class="govuk-visually-hidden">|</span>
                      
      <input id="btn_progress_later_6042" title="Progress case V273EZZ later" type="hidden"
          name="Progress_later" class="govuk-link govuk-link--no-visited-state case__hyperlink case__progress-later-btn govuk-!-display-inline-block govuk-!-text-align-centre govuk-!-padding-bottom-1 hmlr-link--min-width-48 govuk-!-font-size-16" value="Progress later">

                      <span class="govuk-visually-hidden">|</span>
                      
    <a class="govuk-link govuk-link--no-visited-state case__defer-link case__anchor govuk-!-font-size-16 govuk-!-display-inline-block"
    href="#">Defer<span class="govuk-visually-hidden"> case <abbr>V273EZZ</abbr></span>
    </a>

                      <span class="govuk-visually-hidden">|</span>
                  

                  
                      
    <a class="govuk-link govuk-link--no-visited-state case__activity-history-link case__anchor govuk-!-font-size-16 ga_track_event govuk-!-display-inline-block hmlr-link--min-width-48"
    href="#"
    id="link_activity_history_V273EZZ"
    data-ga-category="Activity_History_Link_From_Worklist"
    data-ga-action="Activity History link clicked from worklist page"
    data-ga-label="Worklist_Activity_History_Link"
    >View activity history
    <span class="govuk-visually-hidden"> for <abbr>V273EZZ</abbr></span>
    </a>

                      <span class="govuk-visually-hidden">|</span>
                      
    <a
      class="govuk-!-display-inline-block govuk-link govuk-link--no-visited-state case__more-info-link case__anchor govuk-!-font-size-16"
      href="#">
      More info
    <span class="govuk-visually-hidden">: open daylist for case <abbr>V273EZZ</abbr>. Opens in new window.</span></a>

                      <span class="govuk-visually-hidden">|</span>

                      <input type="submit" name="flagging-btn" id="add_flag_V273EZZ" class="govuk-link govuk-link--no-visited-state govuk-!-display-inline-block govuk-!-text-align-centre govuk-!-padding-bottom-0 hmlr-link--min-width-48 govuk-!-font-size-16 hmlr-flag-icon-btn  case__hyperlink ga_track_event" value="Add flag">                       
                      
                      <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" height="24" width="21" viewBox="0 0 448 512" role="img" aria-labelledby="add_flag_V273EZZ" class="hmlr-flag-icon">
                        <title id="title_V273EZZ">Not flagged</title>
                        <path fill="#0b0c0c" d="M64 32C64 14.3 49.7 0 32 0S0 14.3 0 32L0 64 0 368 0 480c0 17.7 14.3 32 32 32s32-14.3 32-32l0-128 64.3-16.1c41.1-10.3 84.6-5.5 122.5 13.4c44.2 22.1 95.5 24.8 141.7 7.4l34.7-13c12.5-4.7 20.8-16.6 20.8-30l0-247.7c0-23-24.2-38-44.8-27.7l-9.6 4.8c-46.3 23.2-100.8 23.2-147.1 0c-35.1-17.6-75.4-22-113.5-12.5L64 48l0-16z"/></svg>
                  
<!-- hmlr colour #789904 -->
                  
                  </form>
              </div>
            </div>
          </td>
      </tr>
    </tbody> 

<script>//WITH localstorage AND database syncing...

  document.addEventListener('DOMContentLoaded', function() {
  
  function checkIfTblsExist() {
    //const tbl1 = document.getElementById(progress_now_table);
    const tbl2 = document.getElementById(progress_later_table);
    //if (tbl1 || tbl2) {
    if (tbl2) {
      return true;
    } else {
      return false;
    }
  }

  // Set expiry to 365 days from now
  const EXPIRY_DAYS = 365;
  
  // Function to get flag state from localStorage
  function getFlagState(buttonId) {
    const stored = localStorage.getItem('flag_' + buttonId);
    if (stored) {
      const data = JSON.parse(stored);

      if (data.expiry && new Date().getTime() < data.expiry) {// Check if data has expired 
        return data.isFlagged;
      } else {
        localStorage.removeItem('flag_' + buttonId);// Remove expired data

        /*let buttonIdValue = document.getElementById(buttonId).value;//not needed!
        if (buttonIdValue == 'Remove flag'){return data.isFlagged;}*/
      }
    }
    return false; // Default state
  }
  
  // Function to save flag state to localStorage
  function saveFlagState(buttonId, isFlagged) {
    const expiry = new Date().getTime() + (EXPIRY_DAYS * 24 * 60 * 60 * 1000);// a year
    const data = {
      isFlagged: isFlagged,
      expiry: expiry
    };
    localStorage.setItem('flag_' + buttonId, JSON.stringify(data));
  }
  
  // Function to apply flag state to DOM
  function applyFlagState(link, isFlagged) {
    const svgElement = link.nextElementSibling;
    const titleElement = svgElement.querySelector('title');
    
    if (isFlagged) {// Set to flagged state
      svgElement.classList.add('hmlr-flag-icon-show');
      svgElement.setAttribute('aria-hidden', 'false');
      titleElement.textContent = 'This case has been flagged';
      link.value = 'Remove flag';
    } else {// Set to unflagged state
      svgElement.classList.remove('hmlr-flag-icon-show');
      svgElement.setAttribute('aria-hidden', 'true');
      titleElement.textContent = 'Not flagged';
      link.value = 'Add flag';
    }
  }

  // Function to update database via AJAX
  function updateFlagInDatabase(recordId, isFlagged, linkElement) {
    const originalText = linkElement.value.trim();
    linkElement.style.pointerEvents = 'none'; // Prevent multiple clicks
    
    // Make AJAX request
    fetch('/api/update-flag', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        // Add CSRF token if required by your framework
        // 'X-CSRF-Token': document.querySelector('meta[name="csrf-token"]').content
      },
      body: JSON.stringify({
        recordId: recordId,
        isFlagged: isFlagged
      })
    })
    .then(response => {
      if (!response.ok) {
        throw new Error('Network response was not OK');
      }
      return response.json();
    })
    .then(data => {
      // Success
      console.log('Flag updated successfully:', data);
      linkElement.style.pointerEvents = 'auto';
      
      // Optional: Show success message
      // showNotification('Flag updated successfully', 'success');
    })
    .catch(error => {
      // Error - revert UI changes and localStorage
      console.error('Error updating flag:', error);
      
      // Revert localStorage
      const buttonId = linkElement.id;
      saveFlagState(buttonId, !isFlagged);
      
      // Revert the UI to previous state
      linkElement.value = originalText;
      linkElement.style.pointerEvents = 'auto';
      
      // Revert SVG visibility
      const svgElement = linkElement.nextElementSibling;
      const titleElement = svgElement.querySelector('title');
      
      svgElement.classList.toggle('hmlr-flag-icon-show');
      svgElement.setAttribute('aria-hidden', 
        svgElement.getAttribute('aria-hidden') === 'false' ? 'true' : 'false');
      titleElement.textContent = titleElement.textContent === 'This case has been flagged' ? 'Not flagged' : 'This case has been flagged';
      
      // Optional: Show error message
      // alert('Failed to update flag. Please try again.');
      // showNotification('Failed to update flag', 'error');
    });
  }

  if (checkIfTblsExist) { // only run code if we're on the right page!
    const mainContent2 = document.getElementById('main-content');
    const links = mainContent2.querySelectorAll('.hmlr-flag-icon-btn');
    
    links.forEach(link => {
      const buttonId = link.id; // Use the button's ID as unique identifier
      
      // Load and apply saved state when page loads
      const savedState = getFlagState(buttonId);
      applyFlagState(link, savedState);
      
      // Add click event listener
      link.addEventListener('click', function(e) {
        e.preventDefault();
        
        // Get the record ID from the link's ID 
        const recordId = this.id.replace('add_flag_', '');
        
        const svgElement = this.nextElementSibling;
        const titleElement = svgElement.querySelector('title');
        
        // Toggle the visual state
        svgElement.classList.toggle('hmlr-flag-icon-show');
        svgElement.setAttribute('aria-hidden', svgElement.getAttribute('aria-hidden') === 'false' ? 'true' : 'false');
        titleElement.textContent = titleElement.textContent === 'This case has been flagged' ? 'Not flagged' : 'This case has been flagged';
        this.value = this.value.trim() === 'Remove flag' ? 'Add flag' : 'Remove flag';
        
        // Determine current state
        const isFlagged = this.value.trim() === 'Remove flag';
        
        // Save to localStorage immediately
        saveFlagState(buttonId, isFlagged);
        
        // Update database
        //updateFlagInDatabase(recordId, isFlagged, this); //<<<<<<<<<<<<<< UNCOMMENT THIS LINE TO SYNC WITH DATABASE <<<<<<<<<<<<<<<<<<<<<
        
        this.blur(); // remove focus
      });
    });
  }
  
});
</script>  

    <!--script>
      //WITH local storage version...

      document.addEventListener('DOMContentLoaded', function() {
        
        function checkIfTblsExist() {
          const tbl1 = document.getElementById(progress_now_table);
          const tbl2 = document.getElementById(progress_later_table);
          if (tbl1 || tbl2) {
            return true;
          } else {
            return false;
          }
        }

        if (checkIfTblsExist) { // only run code if we're on the right page!
          const mainContent2 = document.getElementById('main-content');
          const links = mainContent2.querySelectorAll('.hmlr-flag-icon-btn');
          
          // Set expiry to 365 days from now
          const EXPIRY_DAYS = 365;
          
          // Function to get flag state from localStorage
          function getFlagState(buttonId) {
            const stored = localStorage.getItem('flag_' + buttonId);
            if (stored) {
              const data = JSON.parse(stored);
              // Check if data has expired
              if (data.expiry && new Date().getTime() < data.expiry) {
                return data.isFlagged;
              } else {
                // Remove expired data
                localStorage.removeItem('flag_' + buttonId);
              }
            }
            return false; // Default state
          }
          
          // Function to save flag state to localStorage
          function saveFlagState(buttonId, isFlagged) {
            const expiry = new Date().getTime() + (EXPIRY_DAYS * 24 * 60 * 60 * 1000);
            const data = {
              isFlagged: isFlagged,
              expiry: expiry
            };
            localStorage.setItem('flag_' + buttonId, JSON.stringify(data));
          }
          
          // Function to apply flag state to DOM
          function applyFlagState(link, isFlagged) {
            const svgElement = link.nextElementSibling;
            const titleElement = svgElement.querySelector('title');
            
            if (isFlagged) {
              // Set to flagged state
              svgElement.classList.add('hmlr-flag-icon-show');
              svgElement.setAttribute('aria-hidden', 'false');
              titleElement.textContent = 'This case has been flagged';
              link.value = 'Remove flag';
            } else {
              // Set to unflagged state
              svgElement.classList.remove('hmlr-flag-icon-show');
              svgElement.setAttribute('aria-hidden', 'true');
              titleElement.textContent = 'Not flagged';
              link.value = 'Add flag';
            }
          }

          links.forEach(link => {
            const buttonId = link.id; // Use the button's ID as unique identifier

            // Load and apply saved state when page loads
            const savedState = getFlagState(buttonId);
            applyFlagState(link, savedState);
            
            // Add click event listener
            link.addEventListener('click', function(e) {
              e.preventDefault();
              
              const svgElement = this.nextElementSibling;
              const titleElement = svgElement.querySelector('title');
              
              // Toggle the visual state
              svgElement.classList.toggle('hmlr-flag-icon-show');
              svgElement.setAttribute('aria-hidden', svgElement.getAttribute('aria-hidden') === 'false' ? 'true' : 'false');
              titleElement.textContent = titleElement.textContent === 'This case has been flagged' ? 'Not flagged' : 'This case has been flagged';
              this.value = this.value.trim() === 'Remove flag' ? 'Add flag' : 'Remove flag';
              
              // Determine current state and save to localStorage
              const isFlagged = this.value.trim() === 'Remove flag';
              saveFlagState(buttonId, isFlagged);
              
              this.blur(); // remove focus
            });
          });
        }
        
      });

    </script-->
 
    <!--script> //NON- local storage version...
      document.addEventListener('DOMContentLoaded', function() {
    
    
        function checkIfTblsExist() {
          const tbl1 = document.getElementById(progress_now_table);
          const tbl2 = document.getElementById(progress_later_table);
          if (tbl1 || tbl2) {
              return true;
          } else {
              return false;
          }
        }
    
        if (checkIfTblsExist) {//only run code if we're on the right page!
          const mainContent2 = document.getElementById('main-content');
          const links = mainContent2.querySelectorAll('.hmlr-flag-icon-btn');

          links.forEach(link => {//loop through each link and add a click event 
            link.addEventListener('click', function(e) {
              e.preventDefault(); 
              
              const svgElement = this.nextElementSibling;// Find the sibling svg element
              const titleElement = svgElement.querySelector('title');
                
              svgElement.classList.toggle('hmlr-flag-icon-show');
              svgElement.setAttribute('aria-hidden', svgElement.getAttribute('aria-hidden') === 'false' ? 'true' : 'false');
              titleElement.textContent = titleElement.textContent === 'This case has been flagged' ? 'Not flagged' : 'This case has been flagged';

              this.value = this.value.trim() === 'Remove flag' ? 'Add flag' : 'Remove flag';//toggle btn value
              this.blur();//remove focus
            });
          });
        }
    
      });
    </script--> 
    {% endif %}

    <tbody data-case-ref="V519SWW" class="case">
      <tr id="row_6042" class="govuk-table__row case__data_row " >
        <td class="case__date" id="V519SWW_priority_date" headers="progress_later_priority_dates" data-table-dynamic="Priority date">
              
              17 July 2023
            
        </td>
        <td class="case__title-number" id="V519SWW_title_number" headers="progress_later_title_numbers" data-table-dynamic="Title number">
            <span class="case__inc"></span>
            DT102641

            <strong class="govuk-tag-expedite govuk-tag">
              Expedite
            </strong>
            
        </td>
        <td id="V519SWW_abr" class="case__abr" headers="progress_later_abrs" data-table-dynamic="ABR">
            V519SWW
            <div></div>
        </td>
        <td id="V519SWW_cat" class="case__category" headers="progress_later_categories" data-table-dynamic="Category">
          Application Processing: Executive Register Update Standard
        </td>
        <td class="case__date" id="V519SWW_dobtained" headers="progress_later_dates_obtained" data-table-dynamic="Date obtained">
            
            23 February 2024
            
        </td>
        <td id="V519SWW_next_action" class="case__next-action" headers="progress_later_next_actions" data-table-dynamic="Next action">
            
                New - Start to process
            
        </td>
      </tr>
      <tr id="row_6042_actions" class="govuk-table__row case__actions">
          <td colspan="6" data-table-dynamic="Options">
            <div class="case__actions-wrapper">
              <div class="case__left-hand-actions actions-spacing">
                <a class="govuk-link govuk-link--no-visited-state actions-spacing case__anchor govuk-!-font-size-16 govuk-!-display-inline-block"
                  href="#">Return to <abbr title="e-serve">ESRV</abbr>
                  <span class="govuk-visually-hidden">: case <abbr>V519SWW</abbr> to <abbr>DB2</abbr></span>
                </a>
              </div>
              <div class="case__right-hand-actions actions-spacing">

                  <form class="case__form" novalidate
                      id="change_state_6042"
                      action="#"
                      method="post"
                      onsubmit="btn_await_lawyer_6042.disabled = true;
                                btn_progress_now_6042.disabled = true;
                                btn_progress_later_6042.disabled = true;">
                    
                    <input id="btn_await_lawyer_3011" title="Refer case V519SWW to a lawyer" type="submit" name="Waiting_for_lawyer" class="govuk-link govuk-link--no-visited-state case__hyperlink case__await_lawyer_btn govuk-!-display-inline-block govuk-!-text-align-centre govuk-!-padding-bottom-1 hmlr-link--min-width-48 govuk-!-font-size-16" value="Waiting for lawyer" formaction="await_lawyer/3011?lr_ref_number=DU164181&amp;lr_work_ref=D348RWW">

                    <span class="govuk-visually-hidden">|</span>
                      
    <a class="govuk-link govuk-link--no-visited-state case__refer-link case__anchor govuk-!-font-size-16 govuk-!-display-inline-block"
    href="#">Refer<span class="govuk-visually-hidden"> case <abbr>V519SWW</abbr></span>
    </a>

                      <span class="govuk-visually-hidden">|</span>
                      
      <input id="btn_progress_now_6042" title="Move case V519SWW into your worklist" type="submit"
          name="Work_on_this" class="govuk-!-display-inline-block govuk-link case__hyperlink case__progress-later-btn govuk-!-font-size-16" value="Work on this">

                      <span class="govuk-visually-hidden">|</span>
                      
      <input id="btn_progress_later_6042" title="Progress case V519SWW later" type="hidden"
          name="Progress_later" class="govuk-link govuk-link--no-visited-state case__hyperlink case__progress-later-btn govuk-!-display-inline-block govuk-!-text-align-centre govuk-!-padding-bottom-1 hmlr-link--min-width-48 govuk-!-font-size-16" value="Progress later">

                      <span class="govuk-visually-hidden">|</span>
                      
    <a class="govuk-link govuk-link--no-visited-state case__defer-link case__anchor govuk-!-font-size-16 govuk-!-display-inline-block"
    href="#">Defer<span class="govuk-visually-hidden"> case <abbr>V519SWW</abbr></span>
    </a>

                      <span class="govuk-visually-hidden">|</span>
                  

                  
                      
    <a class="govuk-link govuk-link--no-visited-state case__activity-history-link case__anchor govuk-!-font-size-16 ga_track_event govuk-!-display-inline-block hmlr-link--min-width-48"
    href="#"
    id="link_activity_history_V519SWW"
    data-ga-category="Activity_History_Link_From_Worklist"
    data-ga-action="Activity History link clicked from worklist page"
    data-ga-label="Worklist_Activity_History_Link"
    >View activity history
    <span class="govuk-visually-hidden"> for <abbr>V519SWW</abbr></span>
    </a>

                      <span class="govuk-visually-hidden">|</span>
                      
    <a
      class="govuk-!-display-inline-block govuk-link govuk-link--no-visited-state case__more-info-link case__anchor govuk-!-font-size-16"
      href="#">
      More info
    <span class="govuk-visually-hidden">: open daylist for case <abbr>V519SWW</abbr>. Opens in new window.</span></a>

                      <span class="govuk-visually-hidden">|</span>
                  

                  
                  </form>
              </div>
            </div>
          </td>
      </tr>
    </tbody>

    <tbody data-case-ref="Y674RWW" class="case">
      <tr id="row_1075" class="govuk-table__row case__data_row">
        <td class="case__date" id="Y674RWW_priority_date" headers="progress_later_priority_dates" data-table-dynamic="Priority date">
          11 April 2022
        </td>
        <td class="case__title-number" id="Y674RWW_title_number" headers="progress_later_title_numbers" data-table-dynamic="Title number">
            <span class="case__inc"></span>
            DU164190 

            <strong class="govuk-tag-expedite govuk-tag">
              Expedite
            </strong>
            
        </td>
        <td id="Y674RWW_abr" class="case__abr" headers="progress_later_abrs" data-table-dynamic="ABR">
            Y674RWW
            <div></div>
        </td>
        <td id="Y674RWW_cat" class="case__category" headers="progress_later_categories" data-table-dynamic="Category">
           Volume Register Update
        </td>
        <td class="case__date" id="Y674RWW_dobtained" headers="progress_later_dates_obtained" data-table-dynamic="Date obtained">
            6 June 2024
        </td>
        <td id="Y674RWW_next_action" class="case__next-action" headers="progress_later_next_actions" data-table-dynamic="Next action">
            Consider referral from<br>
    
            Michaela Webber<br>
        </td>
      </tr>
      <tr id="row_1075_actions" class="govuk-table__row case__actions">
                <td colspan="6" data-table-dynamic="Options">
                  <div class="case__actions-wrapper">
                    <div class="case__left-hand-actions actions-spacing">
        
                    <a class="govuk-link govuk-link--no-visited-state actions-spacing case__anchor govuk-!-font-size-16 govuk-!-display-inline-block" href="#">Return to <abbr title="e-serve">ESRV</abbr>
          <span class="govuk-visually-hidden">: case <abbr>Y674RWW</abbr> to <abbr>DB2</abbr></span></a>

                  

              </div>

              <div class="case__right-hand-actions actions-spacing">

                  <form class="case__form" novalidate
                      id="change_state_1075"
                      action="#"
                      method="post"
                      onsubmit="btn_await_lawyer_1075.disabled = true;
                                btn_progress_now_1075.disabled = true;
                                btn_progress_later_1075.disabled = true;">
                    
                    <input id="btn_await_lawyer_3011" title="Refer case Y674RWW to a lawyer" type="submit" name="Waiting_for_lawyer" class="govuk-link govuk-link--no-visited-state case__hyperlink case__await_lawyer_btn govuk-!-display-inline-block govuk-!-text-align-centre govuk-!-padding-bottom-1 hmlr-link--min-width-48 govuk-!-font-size-16" value="Waiting for lawyer" formaction="await_lawyer/3011?lr_ref_number=DU164181&amp;lr_work_ref=D348RWW">

                    <span class="govuk-visually-hidden">|</span>
                      
    <a class="govuk-link govuk-link--no-visited-state case__refer-link case__anchor govuk-!-font-size-16 govuk-!-display-inline-block"
    href="#">Refer<span class="govuk-visually-hidden"> case <abbr>Y674RWW</abbr></span>
    </a>

    <span class="govuk-visually-hidden">|</span>

    <input id="btn_progress_now_1075" title="Move case Y674RWW into your worklist" type="submit"
    name="Work_on_this" class="govuk-!-display-inline-block govuk-link case__hyperlink case__progress-later-btn govuk-!-font-size-16" value="Work on this">

    <span class="govuk-visually-hidden">|</span>

    <input id="btn_progress_later_1075" title="Progress case Y674RWW later" type="hidden"
    name="Progress_later" class="govuk-link govuk-link--no-visited-state case__hyperlink case__progress-later-btn govuk-!-display-inline-block govuk-!-text-align-centre govuk-!-padding-bottom-1 hmlr-link--min-width-48 govuk-!-font-size-16" value="Progress later">

    <span class="govuk-visually-hidden">|</span>
                      
    <a class="govuk-link govuk-link--no-visited-state case__defer-link case__anchor govuk-!-font-size-16 govuk-!-display-inline-block"
    href="#">Defer<span class="govuk-visually-hidden"> case <abbr>Y674RWW</abbr></span>
    </a>

    <span class="govuk-visually-hidden">|</span>
                      
    <a class="govuk-link govuk-link--no-visited-state case__activity-history-link case__anchor govuk-!-font-size-16 ga_track_event govuk-!-display-inline-block hmlr-link--min-width-48"
    href="#"
    id="link_activity_history_Y674RWW"
    data-ga-category="Activity_History_Link_From_Worklist"
    data-ga-action="Activity History link clicked from worklist page"
    data-ga-label="Worklist_Activity_History_Link"
    >View activity history
    <span class="govuk-visually-hidden"> for <abbr>Y674RWW</abbr></span>
    </a>

    <span class="govuk-visually-hidden">|</span>
                      
    <a class="govuk-!-display-inline-block govuk-link govuk-link--no-visited-state case__more-info-link case__anchor govuk-!-font-size-16"
      href="#">
      More info
    <span class="govuk-visually-hidden">: open daylist for case <abbr>Y674RWW</abbr>. Opens in new window.</span></a>

    <span class="govuk-visually-hidden">|</span>
                </form>
            </div>
          </div>
        </td>
    </tr>
    </tbody>

    {% if (showNotes == 'true') %}
    
    {% include "../includes/inc_cases-with-notes-functionality.html" %}

    {% endif %}

    <tbody data-case-ref="K588WWW" class="case">
        <tr id="row_11492" class="govuk-table__row case__data_row">
          <td class="case__date" id="K588WWW_priority_date" headers="progress_later_priority_dates" data-table-dynamic="Priority date">
                6 June 2024
          </td>
          <td class="case__title-number" id="K588WWW_title_number" headers="progress_later_title_numbers" data-table-dynamic="Title number">
              <span class="case__inc"></span>
              DU164222
              
          </td>
          <td id="K588WWW_abr" class="case__abr" headers="progress_later_abrs" data-table-dynamic="ABR">
              K588WWW
              <div></div>
          </td>
          <td id="K588WWW_cat" class="case__category" headers="progress_later_categories" data-table-dynamic="Category">
              Executive Register Update Standard
          </td>
          <td class="case__date" id="K588WWW_dobtained" headers="progress_later_dates_obtained" data-table-dynamic="Date obtained">
              
              6 June 2024
              
          </td>
          <td id="K588WWW_next_action" class="case__next-action" headers="progress_later_next_actions" data-table-dynamic="Next actions">
                          Consider referral from<br>
                          Eldridge Doumbe<br>
          </td>
        </tr>
        <tr id="row_11492_actions" class="govuk-table__row case__actions">
            <td colspan="6" data-table-dynamic="Options">
              <div class="case__actions-wrapper">
                <div class="case__left-hand-actions actions-spacing">
                  <a class="govuk-link govuk-link--no-visited-state actions-spacing case__anchor govuk-!-font-size-16 govuk-!-display-inline-block"
                    href="#">Return to <abbr title="e-serve">ESRV</abbr>
                    <span class="govuk-visually-hidden">: case <abbr>K588WWW</abbr> to <abbr>DB2</abbr></span>
                  </a>
                </div>
                <div class="case__right-hand-actions actions-spacing">
    
                    <form class="case__form" novalidate
                        id="change_state_11492"
                        action="#"
                        method="post"
                        onsubmit="btn_await_lawyer_11492.disabled = true;
                                  btn_progress_now_11492.disabled = true;
                                  btn_progress_later_11492.disabled = true;">
                   
                      
                      
    
                   <input id="btn_await_lawyer_3011" title="Refer case K588WWW to a lawyer" type="submit" name="Waiting_for_lawyer" class="govuk-link govuk-link--no-visited-state case__hyperlink case__await_lawyer_btn govuk-!-display-inline-block govuk-!-text-align-centre govuk-!-padding-bottom-1 hmlr-link--min-width-48 govuk-!-font-size-16" value="Waiting for lawyer" formaction="await_lawyer/3011?lr_ref_number=DU164181&amp;lr_work_ref=D348RWW">
    
                   <span class="govuk-visually-hidden">|</span>
    
                        <span class="govuk-visually-hidden">|</span>
                        
    <a class="govuk-link govuk-link--no-visited-state case__refer-link case__anchor govuk-!-font-size-16 govuk-!-display-inline-block"
      href="#">Refer<span class="govuk-visually-hidden"> case <abbr>K588WWW</abbr></span>
    </a>
    
                        <span class="govuk-visually-hidden">|</span>
                        
        <input id="btn_progress_now_11492" title="Move case K588WWW into your worklist" type="submit"
            name="Work_on_this" class="govuk-!-display-inline-block govuk-link case__hyperlink case__progress-later-btn govuk-!-font-size-16" value="Work on this">
    
                        <span class="govuk-visually-hidden">|</span>
                        
        <input id="btn_progress_later_11492" title="Progress case K588WWW later" type="hidden"
            name="Progress_later" class="govuk-link govuk-link--no-visited-state case__hyperlink case__progress-later-btn govuk-!-display-inline-block govuk-!-text-align-centre govuk-!-padding-bottom-1 hmlr-link--min-width-48 govuk-!-font-size-16" value="Progress later">
    
                        <span class="govuk-visually-hidden">|</span>
                        
    <a class="govuk-link govuk-link--no-visited-state case__defer-link case__anchor govuk-!-font-size-16 govuk-!-display-inline-block"
      href="#">Defer<span class="govuk-visually-hidden"> case <abbr>K588WWW</abbr></span>
    </a>
    
                        <span class="govuk-visually-hidden">|</span>
                    
    
                    
                        
    <a class="govuk-link govuk-link--no-visited-state case__activity-history-link case__anchor govuk-!-font-size-16 ga_track_event govuk-!-display-inline-block hmlr-link--min-width-48"
      href="#"
      id="link_activity_history_K588WWW"
      data-ga-category="Activity_History_Link_From_Worklist"
      data-ga-action="Activity History link clicked from worklist page"
      data-ga-label="Worklist_Activity_History_Link"
      >View activity history
      <span class="govuk-visually-hidden"> for <abbr>K588WWW</abbr></span>
    </a>
    
                        <span class="govuk-visually-hidden">|</span>
                        
    <a
        class="govuk-!-display-inline-block govuk-link govuk-link--no-visited-state case__more-info-link case__anchor govuk-!-font-size-16"
        href="#">
        More info
    <span class="govuk-visually-hidden">: open daylist for case <abbr>K588WWW</abbr>. Opens in new window.</span></a>
    
                        <span class="govuk-visually-hidden">|</span>
                    
    
                    
                    </form>
                </div>
              </div>
            </td>
        </tr>
    </tbody>

    <tbody data-case-ref="V444SWW" class="case">
      <tr id="row_6042" class="govuk-table__row case__data_row " >
        <td class="case__date" id="V444SWW_priority_date" headers="progress_later_priority_dates" data-table-dynamic="Priority date">
              
              19 August 2024
            
        </td>
        <td class="case__title-number" id="V444SWW_title_number" headers="progress_later_title_numbers" data-table-dynamic="Title number">
            <span class="case__inc"></span>
            DT102641
            
        </td>
        <td id="V444SWW_abr" class="case__abr" headers="progress_later_abrs" data-table-dynamic="ABR">
            V444SWW
            <div></div>
        </td>
        <td id="V444SWW_cat" class="case__category" headers="progress_later_categories" data-table-dynamic="Category">
          Application Processing: Executive Register Update Standard
        </td>
        <td class="case__date" id="V444SWW_dobtained" headers="progress_later_dates_obtained" data-table-dynamic="Date obtained">
            
            23 December 2024
            
        </td>
        <td id="V444SWW_next_action" class="case__next-action" headers="progress_later_next_actions" data-table-dynamic="Next action">
            
                New - Start to process
            
        </td>
      </tr>
      <tr id="row_6042_actions" class="govuk-table__row case__actions">
          <td colspan="6" data-table-dynamic="Options">
            <div class="case__actions-wrapper">
              <div class="case__left-hand-actions actions-spacing">
                <a class="govuk-link govuk-link--no-visited-state actions-spacing case__anchor govuk-!-font-size-16 govuk-!-display-inline-block"
                  href="#">Return to <abbr title="e-serve">ESRV</abbr>
                  <span class="govuk-visually-hidden">: case <abbr>V444SWW</abbr> to <abbr>DB2</abbr></span>
                </a>
              </div>
              <div class="case__right-hand-actions actions-spacing">
    
                  <form class="case__form" novalidate
                      id="change_state_6042"
                      action="#"
                      method="post"
                      onsubmit="btn_await_lawyer_6042.disabled = true;
                                btn_progress_now_6042.disabled = true;
                                btn_progress_later_6042.disabled = true;">
                    
                    <input id="btn_await_lawyer_3011" title="Refer case V444SWW to a lawyer" type="submit" name="Waiting_for_lawyer" class="govuk-link govuk-link--no-visited-state case__hyperlink case__await_lawyer_btn govuk-!-display-inline-block govuk-!-text-align-centre govuk-!-padding-bottom-1 hmlr-link--min-width-48 govuk-!-font-size-16" value="Waiting for lawyer" formaction="await_lawyer/3011?lr_ref_number=DU164181&amp;lr_work_ref=D348RWW">
    
                      <span class="govuk-visually-hidden">|</span>
    
                      
    <a class="govuk-link govuk-link--no-visited-state case__refer-link case__anchor govuk-!-font-size-16 govuk-!-display-inline-block"
    href="#">Refer<span class="govuk-visually-hidden"> case <abbr>V444SWW</abbr></span>
    </a>
    
                      <span class="govuk-visually-hidden">|</span>
                      
      <input id="btn_progress_now_6042" title="Move case V444SWW into your worklist" type="submit"
          name="Work_on_this" class="govuk-!-display-inline-block govuk-link case__hyperlink case__progress-later-btn govuk-!-font-size-16" value="Work on this">
    
                      <span class="govuk-visually-hidden">|</span>
                      
      <input id="btn_progress_later_6042" title="Progress case V444SWW later" type="hidden"
          name="Progress_later" class="govuk-link govuk-link--no-visited-state case__hyperlink case__progress-later-btn govuk-!-display-inline-block govuk-!-text-align-centre govuk-!-padding-bottom-1 hmlr-link--min-width-48 govuk-!-font-size-16" value="Progress later">
    
                      <span class="govuk-visually-hidden">|</span>
                      
    <a class="govuk-link govuk-link--no-visited-state case__defer-link case__anchor govuk-!-font-size-16 govuk-!-display-inline-block"
    href="#">Defer<span class="govuk-visually-hidden"> case <abbr>V444SWW</abbr></span>
    </a>
    
                      <span class="govuk-visually-hidden">|</span>
                  
    
                  
                      
    <a class="govuk-link govuk-link--no-visited-state case__activity-history-link case__anchor govuk-!-font-size-16 ga_track_event govuk-!-display-inline-block hmlr-link--min-width-48"
    href="#"
    id="link_activity_history_V444SWW"
    data-ga-category="Activity_History_Link_From_Worklist"
    data-ga-action="Activity History link clicked from worklist page"
    data-ga-label="Worklist_Activity_History_Link"
    >View activity history
    <span class="govuk-visually-hidden"> for <abbr>V444SWW</abbr></span>
    </a>
    
                      <span class="govuk-visually-hidden">|</span>
                      
    <a
      class="govuk-!-display-inline-block govuk-link govuk-link--no-visited-state case__more-info-link case__anchor govuk-!-font-size-16"
      href="#">
      More info
    <span class="govuk-visually-hidden">: open daylist for case <abbr>V444SWW</abbr>. Opens in new window.</span></a>
    
                      <span class="govuk-visually-hidden">|</span>
                  
    
                  
                  </form>
              </div>
            </div>
          </td>
      </tr>
    </tbody>

    <tbody data-case-ref="Y555RWW" class="case">
        <tr id="row_1075" class="govuk-table__row case__data_row">
          <td class="case__date" id="Y555RWW_priority_date" headers="progress_later_priority_dates" data-table-dynamic="Priority date">
            8 April 2023
          </td>
          <td class="case__title-number" id="Y555RWW_title_number" headers="progress_later_title_numbers" data-table-dynamic="Title number">
              <span class="case__inc"></span>
              DU164190
              
          </td>
          <td id="Y555RWW_abr" class="case__abr" headers="progress_later_abrs" data-table-dynamic="ABR">
              Y555RWW
              <div></div>
          </td>
          <td id="Y555RWW_cat" class="case__category" headers="progress_later_categories" data-table-dynamic="Category">
    Volume Register Update
          </td>
          <td class="case__date" id="Y555RWW_dobtained" headers="progress_later_dates_obtained" data-table-dynamic="Date obtained">
              
              12 June 2023
              
          </td>
          <td id="Y555RWW_next_action" class="case__next-action" headers="progress_later_next_actions" data-table-dynamic="Next action">
              
                  
                          Consider referral from<br>
                  
                          Michaela Webber<br>
                  
              
          </td>
        </tr>
        <tr id="row_1075_actions" class="govuk-table__row case__actions">
                  <td colspan="6" data-table-dynamic="Options">
                    <div class="case__actions-wrapper">
                      <div class="case__left-hand-actions actions-spacing">
          
                      <a class="govuk-link govuk-link--no-visited-state actions-spacing case__anchor govuk-!-font-size-16 govuk-!-display-inline-block" href="#">Return to <abbr title="e-serve">ESRV</abbr>
            <span class="govuk-visually-hidden">: case <abbr>Y555RWW</abbr> to <abbr>DB2</abbr></span></a>
    
                    
    
                </div>
    
                <div class="case__right-hand-actions actions-spacing">
    
                    <form class="case__form" novalidate
                        id="change_state_1075"
                        action="#"
                        method="post"
                        onsubmit="btn_await_lawyer_1075.disabled = true;
                                  btn_progress_now_1075.disabled = true;
                                  btn_progress_later_1075.disabled = true;">
                      
    
                      <input id="btn_await_lawyer_3011" title="Refer case Y555RWW to a lawyer" type="submit" name="Waiting_for_lawyer" class="govuk-link govuk-link--no-visited-state case__hyperlink case__await_lawyer_btn govuk-!-display-inline-block govuk-!-text-align-centre govuk-!-padding-bottom-1 hmlr-link--min-width-48 govuk-!-font-size-16" value="Waiting for lawyer" formaction="await_lawyer/3011?lr_ref_number=DU164181&amp;lr_work_ref=D348RWW">
    
                      <span class="govuk-visually-hidden">|</span>
    
                      
    <a class="govuk-link govuk-link--no-visited-state case__refer-link case__anchor govuk-!-font-size-16 govuk-!-display-inline-block"
      href="#">Refer<span class="govuk-visually-hidden"> case <abbr>Y555RWW</abbr></span>
    </a>
    
    <span class="govuk-visually-hidden">|</span>
    
    <input id="btn_progress_now_1075" title="Move case Y555RWW into your worklist" type="submit"
    name="Work_on_this" class="govuk-!-display-inline-block govuk-link case__hyperlink case__progress-later-btn govuk-!-font-size-16" value="Work on this">
    
    <span class="govuk-visually-hidden">|</span>
    
    <input id="btn_progress_later_1075" title="Progress case Y555RWW later" type="hidden"
    name="Progress_later" class="govuk-link govuk-link--no-visited-state case__hyperlink case__progress-later-btn govuk-!-display-inline-block govuk-!-text-align-centre govuk-!-padding-bottom-1 hmlr-link--min-width-48 govuk-!-font-size-16" value="Progress later">
    
    <span class="govuk-visually-hidden">|</span>
                        
    <a class="govuk-link govuk-link--no-visited-state case__defer-link case__anchor govuk-!-font-size-16 govuk-!-display-inline-block"
      href="#">Defer<span class="govuk-visually-hidden"> case <abbr>Y555RWW</abbr></span>
    </a>
    
    <span class="govuk-visually-hidden">|</span>
                        
    <a class="govuk-link govuk-link--no-visited-state case__activity-history-link case__anchor govuk-!-font-size-16 ga_track_event govuk-!-display-inline-block hmlr-link--min-width-48"
      href="#"
      id="link_activity_history_Y555RWW"
      data-ga-category="Activity_History_Link_From_Worklist"
      data-ga-action="Activity History link clicked from worklist page"
      data-ga-label="Worklist_Activity_History_Link"
      >View activity history
      <span class="govuk-visually-hidden"> for <abbr>Y555RWW</abbr></span>
    </a>
    
    <span class="govuk-visually-hidden">|</span>
                        
    <a class="govuk-!-display-inline-block govuk-link govuk-link--no-visited-state case__more-info-link case__anchor govuk-!-font-size-16"
        href="#">
        More info
    <span class="govuk-visually-hidden">: open daylist for case <abbr>Y555RWW</abbr>. Opens in new window.</span></a>
    
    <span class="govuk-visually-hidden">|</span>
                  </form>
              </div>
            </div>
          </td>
      </tr>
    </tbody>    

  </table>